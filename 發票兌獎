<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>統一發票自動對獎工具</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap');
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f0f9ff;
        }
        .prize-glow {
            box-shadow: 0 0 15px rgba(239, 68, 68, 0.2);
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-2xl mx-auto">
        <!-- 標題區 -->
        <header class="text-center mb-8">
            <h1 class="text-3xl font-bold text-blue-600 mb-2">我的發票小助手</h1>
            <p class="text-gray-500">輸入發票號碼，看看有沒有中獎吧！</p>
        </header>

        <!-- 月份切換區 -->
        <div class="mb-6">
            <label class="block text-sm font-bold text-gray-700 mb-2">請選擇對獎月份：</label>
            <select id="periodSelect" onchange="updatePrizeDisplay()" class="w-full p-3 rounded-xl border-2 border-blue-200 shadow-sm focus:ring-2 focus:ring-blue-400 focus:outline-none bg-white font-bold text-blue-700">
                <option value="910">114年 9-10月</option>
                <option value="78">114年 7-8月</option>
            </select>
        </div>

        <!-- 當期獎號顯示區 -->
        <div class="bg-white rounded-2xl shadow-md border border-blue-100 p-6 mb-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800 flex items-center">
                    <span class="bg-blue-500 text-white w-8 h-8 flex items-center justify-center rounded-full mr-3 text-sm">獎</span>
                    <span id="displayPeriodName">114年 9-10月</span> 中獎號碼
                </h2>
                <span class="text-xs bg-green-100 px-2 py-1 rounded text-green-600 font-bold">已同步最新號碼</span>
            </div>
            
            <div class="grid grid-cols-1 gap-3">
                <div class="flex justify-between items-center bg-red-50 p-3 rounded-xl border border-red-100">
                    <span class="text-red-700 font-medium text-sm">特別獎 (1000萬)</span>
                    <span id="displaySuper" class="font-mono font-bold text-xl text-red-600">25834483</span>
                </div>
                <div class="flex justify-between items-center bg-orange-50 p-3 rounded-xl border border-orange-100">
                    <span class="text-orange-700 font-medium text-sm">特獎 (200萬)</span>
                    <span id="displayGrand" class="font-mono font-bold text-xl text-orange-600">46587380</span>
                </div>
                <div class="bg-blue-50 p-3 rounded-xl border border-blue-100">
                    <span class="text-blue-700 font-medium text-sm block mb-1">頭獎號碼</span>
                    <div id="displayFirst" class="font-mono font-bold text-lg text-blue-800 flex flex-wrap gap-2">
                        <span>41016094</span>
                        <span>98081574</span>
                        <span>07309261</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 對獎操作區 -->
        <div class="bg-white rounded-2xl shadow-md border border-gray-100 p-6">
            <h2 class="text-xl font-bold mb-4 flex items-center text-gray-800">
                <span class="bg-green-500 text-white w-8 h-8 flex items-center justify-center rounded-full mr-3 text-sm">對</span>
                開始對獎
            </h2>
            <div class="flex flex-col gap-3">
                <div class="flex gap-2">
                    <input type="text" id="userInvoice" maxlength="8" inputmode="numeric" placeholder="輸入發票末8位數字" class="flex-1 border-gray-200 rounded-xl shadow-sm p-4 text-2xl font-mono focus:ring-2 focus:ring-blue-400 focus:outline-none text-center tracking-widest">
                    <button onclick="checkInvoice()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-xl font-bold transition flex items-center">
                        比對
                    </button>
                </div>
                <p class="text-center text-sm text-gray-400 font-medium">✨ 請輸入發票上右邊的 8 位數字 ✨</p>
            </div>
            
            <div id="resultArea" class="mt-6 hidden transition-all duration-500">
                <div id="resultCard" class="p-8 rounded-2xl text-center border-4 shadow-xl">
                    <p id="resultTitle" class="text-3xl font-bold mb-3"></p>
                    <p id="resultAmount" class="text-xl font-medium"></p>
                </div>
            </div>
        </div>

        <!-- 歷史記錄 -->
        <div class="mt-8 px-2">
            <div class="flex justify-between items-center mb-3">
                <h3 class="text-lg font-bold text-gray-600">最近對獎紀錄</h3>
                <button onclick="clearHistory()" class="text-xs text-blue-400 hover:text-red-400 transition">清除紀錄</button>
            </div>
            <div id="historyList" class="space-y-2">
                <p class="text-gray-400 text-sm italic text-center py-4 bg-white/50 rounded-xl">還沒有對獎紀錄喔！</p>
            </div>
        </div>
    </div>

    <script>
        // 資料庫：包含 114 年不同月份的獎號
        const prizeDatabase = {
            "910": {
                name: "114年 9-10月",
                super: "25834483",
                grand: "46587380",
                first: ["41016094", "98081574", "07309261"]
            },
            "78": {
                name: "114年 7-8月",
                super: "53960536",
                grand: "51509866",
                first: ["43074088", "22870220", "38253117"]
            }
        };

        let currentPrize = prizeDatabase["910"];

        // 切換月份時更新顯示與數據
        function updatePrizeDisplay() {
            const selected = document.getElementById('periodSelect').value;
            currentPrize = prizeDatabase[selected];
            
            document.getElementById('displayPeriodName').innerText = currentPrize.name;
            document.getElementById('displaySuper').innerText = currentPrize.super;
            document.getElementById('displayGrand').innerText = currentPrize.grand;
            
            const firstContainer = document.getElementById('displayFirst');
            firstContainer.innerHTML = currentPrize.first.map(num => `<span>${num}</span>`).join('');
            
            // 切換月份時隱藏之前的結果
            document.getElementById('resultArea').classList.add('hidden');
        }

        function checkInvoice() {
            const userNum = document.getElementById('userInvoice').value.trim();
            
            if (!/^\d+$/.test(userNum) || userNum.length < 3) {
                alert("請輸入至少 3 位數字喔！");
                return;
            }

            let winType = "沒中獎";
            let amount = 0;
            let themeClass = "bg-white text-gray-400 border-gray-200";

            if (userNum.length === 8) {
                if (userNum === currentPrize.super) {
                    winType = "特別獎"; amount = 10000000; themeClass = "bg-red-500 text-white border-red-200 prize-glow";
                } else if (userNum === currentPrize.grand) {
                    winType = "特獎"; amount = 2000000; themeClass = "bg-orange-500 text-white border-orange-200";
                }
            }

            if (winType === "沒中獎") {
                for (let first of currentPrize.first) {
                    const userLen = userNum.length;
                    const prizeSuffix = first.slice(-userLen);
                    
                    if (userNum === prizeSuffix) {
                        if (userLen === 8) { winType = "頭獎"; amount = 200000; break; }
                        if (userLen >= 7 && userNum.slice(-7) === first.slice(-7)) { winType = "二獎"; amount = 40000; break; }
                        if (userLen >= 6 && userNum.slice(-6) === first.slice(-6)) { winType = "三獎"; amount = 10000; break; }
                        if (userLen >= 5 && userNum.slice(-5) === first.slice(-5)) { winType = "四獎"; amount = 4000; break; }
                        if (userLen >= 4 && userNum.slice(-4) === first.slice(-4)) { winType = "五獎"; amount = 1000; break; }
                        if (userLen >= 3 && userNum.slice(-3) === first.slice(-3)) { winType = "六獎"; amount = 200; break; }
                    }
                }
                
                if (winType !== "沒中獎") {
                    themeClass = "bg-green-500 text-white border-green-200 shadow-lg";
                }
            }

            showResult(winType, amount, themeClass);
            addHistory(userNum, winType, amount, currentPrize.name);
            document.getElementById('userInvoice').value = "";
            document.getElementById('userInvoice').focus();
        }

        function showResult(type, amount, classes) {
            const area = document.getElementById('resultArea');
            const card = document.getElementById('resultCard');
            area.classList.remove('hidden');
            card.className = `p-8 rounded-2xl text-center border-4 transition-all duration-300 ${classes}`;
            
            const title = document.getElementById('resultTitle');
            const amt = document.getElementById('resultAmount');
            
            if (type === "沒中獎") {
                title.innerText = "可惜沒中獎";
                amt.innerText = "下次手氣一定會更好！";
            } else {
                title.innerText = `恭喜中獎！是${type}`;
                amt.innerText = `獎金估計：$${amount.toLocaleString()} 元`;
            }
        }

        function addHistory(num, type, amount, period) {
            const list = document.getElementById('historyList');
            if (list.querySelector('p.italic')) list.innerHTML = "";
            
            const item = document.createElement('div');
            item.className = "bg-white p-4 rounded-xl shadow-sm border-l-4 flex justify-between items-center transition-all " + (amount > 0 ? "border-green-500 scale-[1.02]" : "border-gray-100");
            
            item.innerHTML = `
                <div class="flex flex-col">
                    <span class="font-mono font-bold text-lg text-gray-700">${num}</span>
                    <span class="text-[10px] text-gray-400">${period}</span>
                </div>
                <span class="${amount > 0 ? 'text-red-500 font-bold' : 'text-gray-300'}">${type} ${amount > 0 ? '$' + amount.toLocaleString() : ''}</span>
            `;
            list.prepend(item);
        }

        function clearHistory() {
            document.getElementById('historyList').innerHTML = '<p class="text-gray-400 text-sm italic text-center py-4 bg-white/50 rounded-xl">還沒有對獎紀錄喔！</p>';
            document.getElementById('resultArea').classList.add('hidden');
        }
    </script>
</body>
</html>